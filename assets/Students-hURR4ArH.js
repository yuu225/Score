import{d as H,r as s,m as S,n as _,p as J,c as K,a as l,w as t,b as r,s as O,f as y,j as f,x as W,y as X,A as Y,E as C,o as U,_ as Z}from"./index-D2HBG-fb.js";const ee={class:"students"},le={class:"card-header"},ae={class:"pagination-container"},te={class:"dialog-footer"},ne=H({__name:"Students",setup(oe){const n=s({studentId:"",name:"",class:"",major:""}),u=s({id:"",studentId:"",name:"",class:"",major:""}),z={studentId:[{required:!0,message:"请输入学号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],class:[{required:!0,message:"请输入班级",trigger:"blur"}],major:[{required:!0,message:"请输入专业",trigger:"blur"}]},F=s(!1),c=s(!1),m=s("add"),I=s(!1),p=s(1),b=s(10),j=s(),V=s(),w=S(()=>_.students.value.filter(o=>!(n.value.studentId&&!o.studentId.includes(n.value.studentId)||n.value.name&&!o.name.includes(n.value.name)||n.value.class&&!o.class.includes(n.value.class)||n.value.major&&!o.major.includes(n.value.major))));S(()=>{const o=(p.value-1)*b.value,e=o+b.value;return w.value.slice(o,e)});const q=()=>{p.value=1},D=()=>{j.value&&j.value.resetFields(),n.value={studentId:"",name:"",class:"",major:""},p.value=1},x=()=>{u.value={id:"",studentId:"",name:"",class:"",major:""},V.value&&V.value.resetFields()},B=()=>{m.value="add",x(),c.value=!0},E=o=>{m.value="edit",u.value={...o},c.value=!0},R=async o=>{try{await Y.confirm("确定要删除这名学生吗？","提示",{type:"warning"}),_.deleteStudent(o.id),C.success("删除成功")}catch{}},T=async()=>{V.value&&await V.value.validate(async o=>{if(o){I.value=!0;try{const e={id:m.value==="add"?String(Date.now()):u.value.id,studentId:u.value.studentId,name:u.value.name,class:u.value.class,major:u.value.major,createTime:m.value==="add"?new Date().toLocaleString():u.value.createTime};if(m.value==="add"){if(_.students.value.some(d=>d.studentId===e.studentId)){C.error("该学号已存在");return}_.addStudent(e)}else _.updateStudent(e);C.success(m.value==="add"?"添加成功":"修改成功"),c.value=!1}catch{C.error(m.value==="add"?"添加失败":"修改失败")}finally{I.value=!1}}})},h=o=>{b.value=o,p.value=1},M=o=>{p.value=o};return J(()=>{_.initData()}),(o,e)=>{const v=r("el-button"),d=r("el-input"),i=r("el-form-item"),k=r("el-form"),g=r("el-table-column"),N=r("el-button-group"),$=r("el-table"),A=r("el-pagination"),P=r("el-card"),L=r("el-dialog"),Q=W("loading");return U(),K("div",ee,[l(P,null,{header:t(()=>[y("div",le,[e[13]||(e[13]=y("h2",null,"学生管理",-1)),l(v,{type:"primary",onClick:B},{default:t(()=>e[12]||(e[12]=[f("添加学生")])),_:1,__:[12]})])]),default:t(()=>[l(k,{model:n.value,ref_key:"queryFormRef",ref:j,inline:"",class:"search-form"},{default:t(()=>[l(i,{label:"学号"},{default:t(()=>[l(d,{modelValue:n.value.studentId,"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.studentId=a),placeholder:"请输入学号",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"姓名"},{default:t(()=>[l(d,{modelValue:n.value.name,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.name=a),placeholder:"请输入姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"班级"},{default:t(()=>[l(d,{modelValue:n.value.class,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.class=a),placeholder:"请输入班级",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"专业"},{default:t(()=>[l(d,{modelValue:n.value.major,"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.major=a),placeholder:"请输入专业",clearable:""},null,8,["modelValue"])]),_:1}),l(i,null,{default:t(()=>[l(v,{type:"primary",onClick:q},{default:t(()=>e[14]||(e[14]=[f("查询")])),_:1,__:[14]}),l(v,{onClick:D},{default:t(()=>e[15]||(e[15]=[f("重置")])),_:1,__:[15]})]),_:1})]),_:1},8,["model"]),O((U(),X($,{data:w.value,style:{width:"100%"}},{default:t(()=>[l(g,{prop:"studentId",label:"学号",width:"120"}),l(g,{prop:"name",label:"姓名",width:"120"}),l(g,{prop:"class",label:"班级",width:"120"}),l(g,{prop:"major",label:"专业"}),l(g,{prop:"createTime",label:"创建时间",width:"180"}),l(g,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[l(N,null,{default:t(()=>[l(v,{type:"primary",size:"small",onClick:G=>E(a)},{default:t(()=>e[16]||(e[16]=[f(" 编辑 ")])),_:2,__:[16]},1032,["onClick"]),l(v,{type:"danger",size:"small",onClick:G=>R(a)},{default:t(()=>e[17]||(e[17]=[f(" 删除 ")])),_:2,__:[17]},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Q,F.value]]),y("div",ae,[l(A,{"current-page":p.value,"onUpdate:currentPage":e[4]||(e[4]=a=>p.value=a),"page-size":b.value,"onUpdate:pageSize":e[5]||(e[5]=a=>b.value=a),total:w.value.length,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",onSizeChange:h,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1}),l(L,{modelValue:c.value,"onUpdate:modelValue":e[11]||(e[11]=a=>c.value=a),title:m.value==="add"?"添加学生":"编辑学生",width:"500px",onClose:x},{footer:t(()=>[y("span",te,[l(v,{onClick:e[10]||(e[10]=a=>c.value=!1)},{default:t(()=>e[18]||(e[18]=[f("取消")])),_:1,__:[18]}),l(v,{type:"primary",onClick:T,loading:I.value},{default:t(()=>e[19]||(e[19]=[f(" 确定 ")])),_:1,__:[19]},8,["loading"])])]),default:t(()=>[l(k,{model:u.value,ref_key:"dialogFormRef",ref:V,rules:z,"label-width":"100px"},{default:t(()=>[l(i,{label:"学号",prop:"studentId"},{default:t(()=>[l(d,{modelValue:u.value.studentId,"onUpdate:modelValue":e[6]||(e[6]=a=>u.value.studentId=a),placeholder:"请输入学号"},null,8,["modelValue"])]),_:1}),l(i,{label:"姓名",prop:"name"},{default:t(()=>[l(d,{modelValue:u.value.name,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value.name=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(i,{label:"班级",prop:"class"},{default:t(()=>[l(d,{modelValue:u.value.class,"onUpdate:modelValue":e[8]||(e[8]=a=>u.value.class=a),placeholder:"请输入班级"},null,8,["modelValue"])]),_:1}),l(i,{label:"专业",prop:"major"},{default:t(()=>[l(d,{modelValue:u.value.major,"onUpdate:modelValue":e[9]||(e[9]=a=>u.value.major=a),placeholder:"请输入专业"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),de=Z(ne,[["__scopeId","data-v-7f188f6c"]]);export{de as default};
