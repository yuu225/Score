import{d as J,r as d,m as z,n as _,p as K,c as O,a as l,w as a,b as n,s as W,f as y,j as v,x as X,y as Y,A as Z,E as C,o as U,_ as ee}from"./index-D2HBG-fb.js";const le={class:"courses"},ae={class:"card-header"},te={class:"pagination-container"},oe={class:"dialog-footer"},re=J({__name:"Courses",setup(ue){const u=d({courseId:"",name:"",teacher:""}),o=d({id:"",courseId:"",name:"",credit:2,teacher:"",createTime:""}),F={courseId:[{required:!0,message:"请输入课程号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入课程名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],credit:[{required:!0,message:"请输入学分",trigger:"blur"},{type:"number",min:.5,max:10,message:"学分范围 0.5-10",trigger:"blur"}],teacher:[{required:!0,message:"请输入教师姓名",trigger:"blur"}]},S=d(!1),f=d(!1),s=d("add"),h=d(!1),p=d(1),b=d(10),I=d(),V=d(),x=z(()=>_.courses.value.filter(r=>!(u.value.courseId&&!r.courseId.includes(u.value.courseId)||u.value.name&&!r.name.includes(u.value.name)||u.value.teacher&&!r.teacher.includes(u.value.teacher))));z(()=>{const r=(p.value-1)*b.value,e=r+b.value;return x.value.slice(r,e)});const q=()=>{p.value=1},D=()=>{I.value&&I.value.resetFields(),u.value={courseId:"",name:"",teacher:""},p.value=1},w=()=>{o.value={id:"",courseId:"",name:"",credit:2,teacher:"",createTime:""},V.value&&V.value.resetFields()},T=()=>{s.value="add",w(),f.value=!0},B=r=>{s.value="edit",o.value={...r},f.value=!0},E=async r=>{try{await Z.confirm("确定要删除这门课程吗？","提示",{type:"warning"}),_.deleteCourse(r.id),C.success("删除成功")}catch{}},R=async()=>{V.value&&await V.value.validate(async r=>{if(r){h.value=!0;try{const e={id:s.value==="add"?String(Date.now()):o.value.id,courseId:o.value.courseId,name:o.value.name,credit:o.value.credit,teacher:o.value.teacher,createTime:s.value==="add"?new Date().toLocaleString():o.value.createTime};if(s.value==="add"){if(_.courses.value.some(m=>m.courseId===e.courseId)){C.error("该课程号已存在");return}_.addCourse(e)}else _.updateCourse(e);C.success(s.value==="add"?"添加成功":"修改成功"),f.value=!1}catch{C.error(s.value==="add"?"添加失败":"修改失败")}finally{h.value=!1}}})},M=r=>{b.value=r,p.value=1},N=r=>{p.value=r};return K(()=>{_.initData()}),(r,e)=>{const i=n("el-button"),m=n("el-input"),c=n("el-form-item"),k=n("el-form"),g=n("el-table-column"),$=n("el-button-group"),A=n("el-table"),P=n("el-pagination"),j=n("el-card"),L=n("el-input-number"),Q=n("el-dialog"),G=X("loading");return U(),O("div",le,[l(j,null,{header:a(()=>[y("div",ae,[e[12]||(e[12]=y("h2",null,"课程管理",-1)),l(i,{type:"primary",onClick:T},{default:a(()=>e[11]||(e[11]=[v("添加课程")])),_:1,__:[11]})])]),default:a(()=>[l(k,{model:u.value,ref_key:"queryFormRef",ref:I,inline:"",class:"search-form"},{default:a(()=>[l(c,{label:"课程号"},{default:a(()=>[l(m,{modelValue:u.value.courseId,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value.courseId=t),placeholder:"请输入课程号",clearable:""},null,8,["modelValue"])]),_:1}),l(c,{label:"课程名"},{default:a(()=>[l(m,{modelValue:u.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>u.value.name=t),placeholder:"请输入课程名",clearable:""},null,8,["modelValue"])]),_:1}),l(c,{label:"教师"},{default:a(()=>[l(m,{modelValue:u.value.teacher,"onUpdate:modelValue":e[2]||(e[2]=t=>u.value.teacher=t),placeholder:"请输入教师姓名",clearable:""},null,8,["modelValue"])]),_:1}),l(c,null,{default:a(()=>[l(i,{type:"primary",onClick:q},{default:a(()=>e[13]||(e[13]=[v("查询")])),_:1,__:[13]}),l(i,{onClick:D},{default:a(()=>e[14]||(e[14]=[v("重置")])),_:1,__:[14]})]),_:1})]),_:1},8,["model"]),W((U(),Y(A,{data:x.value,style:{width:"100%"}},{default:a(()=>[l(g,{prop:"courseId",label:"课程号",width:"120"}),l(g,{prop:"name",label:"课程名称",width:"150"}),l(g,{prop:"credit",label:"学分",width:"100"}),l(g,{prop:"teacher",label:"任课教师",width:"120"}),l(g,{prop:"createTime",label:"创建时间",width:"180"}),l(g,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[l($,null,{default:a(()=>[l(i,{type:"primary",size:"small",onClick:H=>B(t)},{default:a(()=>e[15]||(e[15]=[v(" 编辑 ")])),_:2,__:[15]},1032,["onClick"]),l(i,{type:"danger",size:"small",onClick:H=>E(t)},{default:a(()=>e[16]||(e[16]=[v(" 删除 ")])),_:2,__:[16]},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[G,S.value]]),y("div",te,[l(P,{"current-page":p.value,"onUpdate:currentPage":e[3]||(e[3]=t=>p.value=t),"page-size":b.value,"onUpdate:pageSize":e[4]||(e[4]=t=>b.value=t),total:x.value.length,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",onSizeChange:M,onCurrentChange:N},null,8,["current-page","page-size","total"])])]),_:1}),l(Q,{modelValue:f.value,"onUpdate:modelValue":e[10]||(e[10]=t=>f.value=t),title:s.value==="add"?"添加课程":"编辑课程",width:"500px",onClose:w},{footer:a(()=>[y("span",oe,[l(i,{onClick:e[9]||(e[9]=t=>f.value=!1)},{default:a(()=>e[17]||(e[17]=[v("取消")])),_:1,__:[17]}),l(i,{type:"primary",onClick:R,loading:h.value},{default:a(()=>e[18]||(e[18]=[v(" 确定 ")])),_:1,__:[18]},8,["loading"])])]),default:a(()=>[l(k,{model:o.value,ref_key:"dialogFormRef",ref:V,rules:F,"label-width":"100px"},{default:a(()=>[l(c,{label:"课程号",prop:"courseId"},{default:a(()=>[l(m,{modelValue:o.value.courseId,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.courseId=t),placeholder:"请输入课程号"},null,8,["modelValue"])]),_:1}),l(c,{label:"课程名称",prop:"name"},{default:a(()=>[l(m,{modelValue:o.value.name,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.name=t),placeholder:"请输入课程名称"},null,8,["modelValue"])]),_:1}),l(c,{label:"学分",prop:"credit"},{default:a(()=>[l(L,{modelValue:o.value.credit,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.credit=t),min:.5,max:10,step:.5},null,8,["modelValue"])]),_:1}),l(c,{label:"任课教师",prop:"teacher"},{default:a(()=>[l(m,{modelValue:o.value.teacher,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.teacher=t),placeholder:"请输入教师姓名"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),de=ee(re,[["__scopeId","data-v-a5dfa326"]]);export{de as default};
